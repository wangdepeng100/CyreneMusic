# TuneHub éŸ³æº API æ–‡æ¡£

> **æœ€åæ›´æ–°**: 2025-12-25
> **API ç‰ˆæœ¬**: v1
> **å®˜æ–¹æ–‡æ¡£**: https://api.tunefree.fun/

---

## ğŸ“‹ æ¦‚è¿°

TuneHub æ˜¯ä¸€ä¸ªå…¬å¼€çš„éŸ³ä¹ API æœåŠ¡ï¼Œæä¾›å¤šå¹³å°éŸ³ä¹èµ„æºçš„èšåˆæ¥å£ã€‚

### åŸºæœ¬ä¿¡æ¯

| é¡¹ç›® | å€¼ |
|------|-----|
| **Base URL** | `https://music-dl.sayqz.com` |
| **åè®®** | HTTPS |
| **è®¤è¯æ–¹å¼** | æ— éœ€è®¤è¯ï¼ˆå…¬å¼€ APIï¼‰ |
| **å“åº”æ ¼å¼** | JSON / çº¯æ–‡æœ¬ï¼ˆæ­Œè¯ï¼‰ |

### æ”¯æŒçš„å¹³å°

| å¹³å°ä»£ç  | å¹³å°åç§° |
|----------|----------|
| `netease` | ç½‘æ˜“äº‘éŸ³ä¹ |
| `qq` | QQéŸ³ä¹ |
| `kuwo` | é…·æˆ‘éŸ³ä¹ |

### æ”¯æŒçš„éŸ³è´¨

| éŸ³è´¨ä»£ç  | è¯´æ˜ |
|----------|------|
| `128k` | æ ‡å‡†éŸ³è´¨ (128kbps MP3) |
| `320k` | é«˜éŸ³è´¨ (320kbps MP3) |
| `flac` | æ— æŸéŸ³è´¨ (FLAC) |
| `flac24bit` | Hi-Res é«˜è§£æåº¦æ— æŸ |

---

## ğŸ” API ç«¯ç‚¹

æ‰€æœ‰ API éƒ½ä½¿ç”¨ç»Ÿä¸€å…¥å£ `/api/`ï¼Œé€šè¿‡ `type` å‚æ•°åŒºåˆ†ä¸åŒåŠŸèƒ½ã€‚

### 1. æ­Œæ›²æœç´¢ (Search)

æœç´¢æŒ‡å®šå¹³å°çš„æ­Œæ›²ã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=search&source={source}&keyword={keyword}&limit={limit}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `search` |
| `source` | string | âœ… | å¹³å°ä»£ç : `netease`, `qq`, `kuwo` |
| `keyword` | string | âœ… | æœç´¢å…³é”®è¯ï¼ˆURL ç¼–ç ï¼‰ |
| `limit` | int | âŒ | è¿”å›æ•°é‡ï¼Œé»˜è®¤ 20 |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": "æ­Œæ›²ID",
      "name": "æ­Œæ›²åç§°",
      "artist": "è‰ºæœ¯å®¶",
      "album": "ä¸“è¾‘åç§°",
      "pic": "å°é¢å›¾ç‰‡URL",
      "duration": 240
    }
  ]
}
```

---

### 2. èšåˆæœç´¢ (Aggregate Search)

åŒæ—¶æœç´¢æ‰€æœ‰æ”¯æŒçš„å¹³å°ã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=aggregateSearch&keyword={keyword}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `aggregateSearch` |
| `keyword` | string | âœ… | æœç´¢å…³é”®è¯ï¼ˆURL ç¼–ç ï¼‰ |

---

### 3. è·å–æ’­æ”¾é“¾æ¥ (Music URL)

è·å–æ­Œæ›²çš„æ’­æ”¾ URLã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=url&source={source}&id={id}&br={br}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `url` |
| `source` | string | âœ… | å¹³å°ä»£ç  |
| `id` | string | âœ… | æ­Œæ›² ID |
| `br` | string | âŒ | éŸ³è´¨: `128k`, `320k`, `flac`, `flac24bit` |

**å“åº”è¡Œä¸º**:
- **æˆåŠŸ**: è¿”å› `302 é‡å®šå‘` åˆ°éŸ³é¢‘æ–‡ä»¶ URL
- **å¤±è´¥**: è¿”å› JSON é”™è¯¯ä¿¡æ¯

**ç›´æ¥è·å– URLï¼ˆä¸é‡å®šå‘ï¼‰**:

è‹¥éœ€è¦è·å– URL å­—ç¬¦ä¸²è€Œéé‡å®šå‘ï¼Œå¯ä½¿ç”¨ `type=info` æ¥å£ã€‚

---

### 4. è·å–æ­Œè¯ (Lyrics)

è·å–æ­Œæ›²çš„ LRC æ ¼å¼æ­Œè¯ã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=lrc&source={source}&id={id}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `lrc` |
| `source` | string | âœ… | å¹³å°ä»£ç  |
| `id` | string | âœ… | æ­Œæ›² ID |

**å“åº”**:
- **Content-Type**: `text/plain`
- **æ ¼å¼**: æ ‡å‡† LRC æ­Œè¯æ–‡æœ¬

**å“åº”ç¤ºä¾‹**:
```
[ti:æ­Œæ›²åç§°]
[ar:è‰ºæœ¯å®¶]
[al:ä¸“è¾‘]
[00:00.00]æ­Œè¯ç¬¬ä¸€è¡Œ
[00:05.50]æ­Œè¯ç¬¬äºŒè¡Œ
...
```

---

### 5. è·å–æ­Œæ›²è¯¦æƒ… (Song Info)

è·å–æ­Œæ›²çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬åç§°ã€å°é¢ã€æ’­æ”¾é“¾æ¥å’Œæ­Œè¯ã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=info&source={source}&id={id}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `info` |
| `source` | string | âœ… | å¹³å°ä»£ç  |
| `id` | string | âœ… | æ­Œæ›² ID |

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": "æ­Œæ›²ID",
    "name": "æ­Œæ›²åç§°",
    "artist": "è‰ºæœ¯å®¶",
    "album": "ä¸“è¾‘åç§°",
    "pic": "å°é¢å›¾ç‰‡URL",
    "url": "æ’­æ”¾é“¾æ¥URL",
    "lrc": "æ­Œè¯URLæˆ–æ­Œè¯å†…å®¹"
  }
}
```

---

### 6. è·å–ä¸“è¾‘å°é¢ (Album Cover)

è·å–æ­Œæ›²çš„ä¸“è¾‘å°é¢å›¾ç‰‡ã€‚

**è¯·æ±‚æ–¹å¼**: `GET`

**URL**: `/api/?type=pic&source={source}&id={id}`

**å‚æ•°**:

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `type` | string | âœ… | å›ºå®šä¸º `pic` |
| `source` | string | âœ… | å¹³å°ä»£ç  |
| `id` | string | âœ… | æ­Œæ›² ID |

**å“åº”è¡Œä¸º**:
- è¿”å› `302 é‡å®šå‘` åˆ°å›¾ç‰‡æ–‡ä»¶ URL

---

## ğŸ”§ ä¸é¡¹ç›®é›†æˆ

### å¹³å°ä»£ç æ˜ å°„

å°† `MusicSource` æšä¸¾æ˜ å°„åˆ° TuneHub çš„ `source` å‚æ•°ï¼š

| MusicSource | TuneHub source |
|-------------|----------------|
| `MusicSource.netease` | `netease` |
| `MusicSource.qq` | `qq` |
| `MusicSource.kuwo` | `kuwo` |

**æ³¨æ„**: TuneHub ä¸æ”¯æŒ:
- `MusicSource.kugou` (é…·ç‹—)
- `MusicSource.apple` (Apple Music)
- `MusicSource.local` (æœ¬åœ°éŸ³ä¹)

### éŸ³è´¨æ˜ å°„

å°† `AudioQuality` æšä¸¾æ˜ å°„åˆ° TuneHub çš„ `br` å‚æ•°ï¼š

| AudioQuality | TuneHub br |
|--------------|------------|
| `AudioQuality.standard` | `128k` |
| `AudioQuality.exhigh` | `320k` |
| `AudioQuality.lossless` | `flac` |
| `AudioQuality.hires` | `flac24bit` |
| `AudioQuality.jymaster` | `flac24bit` |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **302 é‡å®šå‘å¤„ç†**:
   - `/api/?type=url` å’Œ `/api/?type=pic` æ¥å£è¿”å› 302 é‡å®šå‘
   - ä½¿ç”¨ `http.get()` æ—¶éœ€è¦ç¦ç”¨è‡ªåŠ¨é‡å®šå‘ï¼Œæˆ–ç›´æ¥ä½¿ç”¨é‡å®šå‘åçš„ URL

2. **æ— éœ€è®¤è¯**:
   - TuneHub æ˜¯å…¬å¼€ APIï¼Œä¸éœ€è¦ API Key æˆ– Token
   - é…ç½®æ—¶åªéœ€è¦ Base URL

3. **æ¨èä½¿ç”¨ `type=info`**:
   - è¯¥æ¥å£ä¸€æ¬¡æ€§è¿”å›æ­Œæ›²ä¿¡æ¯å’Œæ’­æ”¾ URL
   - é¿å…å¤šæ¬¡è¯·æ±‚ï¼Œå‡å°‘å»¶è¿Ÿ

4. **æ­Œè¯æ ¼å¼**:
   - æ­Œè¯è¿”å›æ ‡å‡† LRC æ ¼å¼
   - éœ€è¦ä½¿ç”¨ç°æœ‰çš„ LRC è§£æå™¨å¤„ç†

---

## ğŸ“ å®ç°æ¸…å•

### AudioSourceService ä¿®æ”¹

1. âœ… åœ¨ `AudioSourceType` æšä¸¾æ·»åŠ  `tunehub`
2. âœ… æ·»åŠ  TuneHub å¹³å°ä»£ç æ˜ å°„ (`_tuneHubSourceCodeMap`)
3. âœ… æ·»åŠ  `isTuneHubSourceSupported()` æ–¹æ³•
4. âœ… æ·»åŠ  `getTuneHubSourceCode()` æ–¹æ³•
5. âœ… æ·»åŠ  `getTuneHubQuality()` æ–¹æ³•
6. âœ… æ·»åŠ  `buildTuneHubMusicUrl()` æ–¹æ³•

### MusicService ä¿®æ”¹

1. âœ… æ·»åŠ  `_fetchSongDetailFromTuneHub()` æ–¹æ³•
2. âœ… åœ¨ `fetchSongDetail()` ä¸­æ·»åŠ  TuneHub åˆ†æ”¯

### UI ä¿®æ”¹

1. âœ… æ›´æ–° `_getSourceTypeName()` å’Œ `_getSourceTypeDescription()`
2. âœ… æ·»åŠ  TuneHub é…ç½®è¡¨å•ï¼ˆç±»ä¼¼ OmniParseï¼Œä»…éœ€è¾“å…¥ URLï¼‰
3. âœ… æ·»åŠ ä¿å­˜å’Œæµ‹è¯•è¿æ¥é€»è¾‘
